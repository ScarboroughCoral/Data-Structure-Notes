# OS

> 操作系统相关内容



## 引论



### 计算机的两种运行模式

- 内核态

  > 操作系统对所有硬件具有完全访问权，可以执行机器的任何指令。

- 用户态

  > 只是用了机器指令中的子集，不允许执行影响机器的控制或可进行IO操作的指令。

### 驱动程序作用流程

用户调用libc的printf，libc内部调用write系统调用，write有缓冲区，最终调用驱动程序将缓冲区的数据输出。





### 程序状态字寄存器（Program Status Word,PSW）

> 用户程序通常读入整个状态字，只对少量字段写入。在系统调用和IO中，PSW很重要。

包含：

- 条件码位
- CPU优先级
- 模式（用户态或内核态）
- 其他控制位




## IO

### IO设备

IO设备一般包括两个部分：

- 设备控制器：插在电路板上的一块芯片或一组芯片，这块电路板物理的控制设备。他提供给操作系统（驱动程序）接口，从操作系统接受命令。
- 设备本身



设备驱动程序一般是由控制器厂家写的，必须为所支持的操作系统提供相应的设备驱动程序。

**设备驱动程序一般来说要装入操作系统中，这样可以在内核态运行。如果在用户态执行必须以受控的方式访问设备。**



### 实现输入输出的三种方式

- 忙等待（busy waiting），CPU循环检查。
- 中断
- DMA